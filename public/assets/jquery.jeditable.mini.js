!function($){$.fn.editable=function(t,e){if("disable"==t)return $(this).data("disabled.editable",!0),void 0;if("enable"==t)return $(this).data("disabled.editable",!1),void 0;if("destroy"==t)return $(this).unbind($(this).data("event.editable")).removeData("disabled.editable").removeData("event.editable"),void 0;var i=$.extend({},$.fn.editable.defaults,{target:t},e),n=$.editable.types[i.type].plugin||function(){},s=$.editable.types[i.type].submit||function(){},o=$.editable.types[i.type].buttons||$.editable.types.defaults.buttons,a=$.editable.types[i.type].content||$.editable.types.defaults.content,r=$.editable.types[i.type].element||$.editable.types.defaults.element,h=$.editable.types[i.type].reset||$.editable.types.defaults.reset,l=i.callback||function(){},u=i.onedit||function(){},c=i.onsubmit||function(){},d=i.onreset||function(){},f=i.onerror||h;return i.tooltip&&$(this).attr("title",i.tooltip),i.autowidth="auto"==i.width,i.autoheight="auto"==i.height,this.each(function(){var t=this,e=$(t).width(),p=$(t).height();$(this).data("event.editable",i.event),$.trim($(this).html())||$(this).html(i.placeholder),$(this).bind(i.event,function(d){if(!0!==$(this).data("disabled.editable")&&!t.editing&&!1!==u.apply(this,[i,t])){d.preventDefault(),d.stopPropagation(),i.tooltip&&$(t).removeAttr("title"),0==$(t).width()?(i.width=e,i.height=p):("none"!=i.width&&(i.width=i.autowidth?$(t).width():i.width),"none"!=i.height&&(i.height=i.autoheight?$(t).height():i.height)),$(this).html().toLowerCase().replace(/(;|")/g,"")==i.placeholder.toLowerCase().replace(/(;|")/g,"")&&$(this).html(""),t.editing=!0,t.revert=$(t).html(),$(t).html("");var g=$("<form />");i.cssclass&&("inherit"==i.cssclass?g.attr("class",$(t).attr("class")):g.attr("class",i.cssclass)),i.style&&("inherit"==i.style?(g.attr("style",$(t).attr("style")),g.css("display",$(t).css("display"))):g.attr("style",i.style));var m,v=r.apply(g,[i,t]);if(i.loadurl){var y=setTimeout(function(){v.disabled=!0,a.apply(g,[i.loadtext,i,t])},100),b={};b[i.id]=t.id,$.isFunction(i.loaddata)?$.extend(b,i.loaddata.apply(t,[t.revert,i])):$.extend(b,i.loaddata),$.ajax({type:i.loadtype,url:i.loadurl,data:b,async:!1,success:function(t){window.clearTimeout(y),m=t,v.disabled=!1}})}else i.data?(m=i.data,$.isFunction(i.data)&&(m=i.data.apply(t,[t.revert,i]))):m=t.revert;a.apply(g,[m,i,t]),v.attr("name",i.name),o.apply(g,[i,t]),$(t).append(g),n.apply(g,[i,t]),$(":input:visible:enabled:first",g).focus(),i.select&&v.select(),v.keydown(function(e){27==e.keyCode&&(e.preventDefault(),h.apply(g,[i,t]))});var y;"cancel"==i.onblur?v.blur(function(){y=setTimeout(function(){h.apply(g,[i,t])},500)}):"submit"==i.onblur?v.blur(function(){y=setTimeout(function(){g.submit()},200)}):$.isFunction(i.onblur)?v.blur(function(){i.onblur.apply(t,[v.val(),i])}):v.blur(function(){}),g.submit(function(e){if(y&&clearTimeout(y),e.preventDefault(),!1!==c.apply(g,[i,t])&&!1!==s.apply(g,[i,t]))if($.isFunction(i.target)){var n=i.target.apply(t,[v.val(),i]);$(t).html(n),t.editing=!1,l.apply(t,[t.innerHTML,i]),$.trim($(t).html())||$(t).html(i.placeholder)}else{var o={};o[i.name]=v.val(),o[i.id]=t.id,$.isFunction(i.submitdata)?$.extend(o,i.submitdata.apply(t,[t.revert,i])):$.extend(o,i.submitdata),"PUT"==i.method&&(o._method="put"),$(t).html(i.indicator);var a={type:"POST",data:o,dataType:"html",url:i.target,success:function(e){"html"==a.dataType&&$(t).html(e),t.editing=!1,l.apply(t,[e,i]),$.trim($(t).html())||$(t).html(i.placeholder)},error:function(e){f.apply(g,[i,t,e])}};$.extend(a,i.ajaxoptions),$.ajax(a)}return $(t).attr("title",i.tooltip),!1})}}),this.reset=function(e){this.editing&&!1!==d.apply(e,[i,t])&&($(t).html(t.revert),t.editing=!1,$.trim($(t).html())||$(t).html(i.placeholder),i.tooltip&&$(t).attr("title",i.tooltip))}})},$.editable={types:{defaults:{element:function(){var t=$('<input type="hidden"></input>');return $(this).append(t),t},content:function(t){$(":input:first",this).val(t)},reset:function(t,e){e.reset(this)},buttons:function(t,e){var i=this;if(t.submit){if(t.submit.match(/>$/))var n=$(t.submit).click(function(){"submit"!=n.attr("type")&&i.submit()});else{var n=$('<button type="submit" />');n.html(t.submit)}$(this).append(n)}if(t.cancel){if(t.cancel.match(/>$/))var s=$(t.cancel);else{var s=$('<button type="cancel" />');s.html(t.cancel)}$(this).append(s),$(s).click(function(){if($.isFunction($.editable.types[t.type].reset))var n=$.editable.types[t.type].reset;else var n=$.editable.types.defaults.reset;return n.apply(i,[t,e]),!1})}}},text:{element:function(t){var e=$("<input />");return"none"!=t.width&&e.width(t.width),"none"!=t.height&&e.height(t.height),e.attr("autocomplete","off"),$(this).append(e),e}},textarea:{element:function(t){var e=$("<textarea />");return t.rows?e.attr("rows",t.rows):"none"!=t.height&&e.height(t.height),t.cols?e.attr("cols",t.cols):"none"!=t.width&&e.width(t.width),$(this).append(e),e}},select:{element:function(){var t=$("<select />");return $(this).append(t),t},content:function(data,settings,original){if(String==data.constructor)eval("var json = "+data);else var json=data;for(var key in json)if(json.hasOwnProperty(key)&&"selected"!=key){var option=$("<option />").val(key).append(json[key]);$("select",this).append(option)}$("select",this).children().each(function(){($(this).val()==json.selected||$(this).text()==$.trim(original.revert))&&$(this).attr("selected","selected")})}}},addInputType:function(t,e){$.editable.types[t]=e}},$.fn.editable.defaults={name:"value",id:"id",type:"text",width:"auto",height:"auto",event:"click.editable",onblur:"cancel",loadtype:"GET",loadtext:"Loading...",placeholder:"Click to edit",loaddata:{},submitdata:{},ajaxoptions:{}}}(jQuery);