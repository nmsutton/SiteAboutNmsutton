/*
* jQuery Form Plugin; v20140218
* http://jquery.malsup.com/form/
* Copyright (c) 2014 M. Alsup; Dual licensed: MIT/GPL
* https://github.com/malsup/form#copyright-and-license
*/
!function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],t):t("undefined"!=typeof jQuery?jQuery:window.Zepto)}(function(t){"use strict";function e(e){var i=e.data;e.isDefaultPrevented()||(e.preventDefault(),t(e.target).ajaxSubmit(i))}function i(e){var i=e.target,n=t(i);if(!n.is("[type=submit],[type=image]")){var s=n.closest("[type=submit]");if(0===s.length)return;i=s[0]}var o=this;if(o.clk=i,"image"==i.type)if(void 0!==e.offsetX)o.clk_x=e.offsetX,o.clk_y=e.offsetY;else if("function"==typeof t.fn.offset){var a=n.offset();o.clk_x=e.pageX-a.left,o.clk_y=e.pageY-a.top}else o.clk_x=e.pageX-i.offsetLeft,o.clk_y=e.pageY-i.offsetTop;setTimeout(function(){o.clk=o.clk_x=o.clk_y=null},100)}function n(){if(t.fn.ajaxSubmit.debug){var e="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(e):window.opera&&window.opera.postError&&window.opera.postError(e)}}var s={};s.fileapi=void 0!==t("<input type='file'/>").get(0).files,s.formdata=void 0!==window.FormData;var o=!!t.fn.prop;t.fn.attr2=function(){if(!o)return this.attr.apply(this,arguments);var t=this.prop.apply(this,arguments);return t&&t.jquery||"string"==typeof t?t:this.attr.apply(this,arguments)},t.fn.ajaxSubmit=function(e){function i(i){var n,s,o=t.param(i,e.traditional).split("&"),a=o.length,r=[];for(n=0;a>n;n++)o[n]=o[n].replace(/\+/g," "),s=o[n].split("="),r.push([decodeURIComponent(s[0]),decodeURIComponent(s[1])]);return r}function a(n){for(var s=new FormData,o=0;o<n.length;o++)s.append(n[o].name,n[o].value);if(e.extraData){var a=i(e.extraData);for(o=0;o<a.length;o++)a[o]&&s.append(a[o][0],a[o][1])}e.data=null;var r=t.extend(!0,{},t.ajaxSettings,e,{contentType:!1,processData:!1,cache:!1,type:h||"POST"});e.uploadProgress&&(r.xhr=function(){var i=t.ajaxSettings.xhr();return i.upload&&i.upload.addEventListener("progress",function(t){var i=0,n=t.loaded||t.position,s=t.total;t.lengthComputable&&(i=Math.ceil(100*(n/s))),e.uploadProgress(t,n,s,i)},!1),i}),r.data=null;var l=r.beforeSend;return r.beforeSend=function(t,i){i.data=e.formData?e.formData:s,l&&l.call(this,t,i)},t.ajax(r)}function r(i){function s(t){var e=null;try{t.contentWindow&&(e=t.contentWindow.document)}catch(i){n("cannot get iframe.contentWindow document: "+i)}if(e)return e;try{e=t.contentDocument?t.contentDocument:t.document}catch(i){n("cannot get iframe.contentDocument: "+i),e=t.document}return e}function a(){function e(){try{var t=s(v).readyState;n("state = "+t),t&&"uninitialized"==t.toLowerCase()&&setTimeout(e,50)}catch(i){n("Server abort: ",i," (",i.name,")"),r(T),j&&clearTimeout(j),j=void 0}}var i=c.attr2("target"),o=c.attr2("action"),a="multipart/form-data",l=c.attr("enctype")||c.attr("encoding")||a;A.setAttribute("target",p),(!h||/post/i.test(h))&&A.setAttribute("method","POST"),o!=f.url&&A.setAttribute("action",f.url),f.skipEncodingOverride||h&&!/post/i.test(h)||c.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),f.timeout&&(j=setTimeout(function(){w=!0,r(C)},f.timeout));var u=[];try{if(f.extraData)for(var d in f.extraData)f.extraData.hasOwnProperty(d)&&(t.isPlainObject(f.extraData[d])&&f.extraData[d].hasOwnProperty("name")&&f.extraData[d].hasOwnProperty("value")?u.push(t('<input type="hidden" name="'+f.extraData[d].name+'">').val(f.extraData[d].value).appendTo(A)[0]):u.push(t('<input type="hidden" name="'+d+'">').val(f.extraData[d]).appendTo(A)[0]));f.iframeTarget||m.appendTo("body"),v.attachEvent?v.attachEvent("onload",r):v.addEventListener("load",r,!1),setTimeout(e,15);try{A.submit()}catch(g){var y=document.createElement("form").submit;y.apply(A)}}finally{A.setAttribute("action",o),A.setAttribute("enctype",l),i?A.setAttribute("target",i):c.removeAttr("target"),t(u).remove()}}function r(e){if(!y.aborted&&!M){if(D=s(v),D||(n("cannot access response document"),e=T),e===C&&y)return y.abort("timeout"),x.reject(y,"timeout"),void 0;if(e==T&&y)return y.abort("server abort"),x.reject(y,"error","server abort"),void 0;if(D&&D.location.href!=f.iframeSrc||w){v.detachEvent?v.detachEvent("onload",r):v.removeEventListener("load",r,!1);var i,o="success";try{if(w)throw"timeout";var a="xml"==f.dataType||D.XMLDocument||t.isXMLDoc(D);if(n("isXml="+a),!a&&window.opera&&(null===D.body||!D.body.innerHTML)&&--N)return n("requeing onLoad callback, DOM not available"),setTimeout(r,250),void 0;var h=D.body?D.body:D.documentElement;y.responseText=h?h.innerHTML:null,y.responseXML=D.XMLDocument?D.XMLDocument:D,a&&(f.dataType="xml"),y.getResponseHeader=function(t){var e={"content-type":f.dataType};return e[t.toLowerCase()]},h&&(y.status=Number(h.getAttribute("status"))||y.status,y.statusText=h.getAttribute("statusText")||y.statusText);var l=(f.dataType||"").toLowerCase(),u=/(json|script|text)/.test(l);if(u||f.textarea){var c=D.getElementsByTagName("textarea")[0];if(c)y.responseText=c.value,y.status=Number(c.getAttribute("status"))||y.status,y.statusText=c.getAttribute("statusText")||y.statusText;else if(u){var p=D.getElementsByTagName("pre")[0],g=D.getElementsByTagName("body")[0];p?y.responseText=p.textContent?p.textContent:p.innerText:g&&(y.responseText=g.textContent?g.textContent:g.innerText)}}else"xml"==l&&!y.responseXML&&y.responseText&&(y.responseXML=I(y.responseText));try{E=B(y,l,f)}catch(b){o="parsererror",y.error=i=b||o}}catch(b){n("error caught: ",b),o="error",y.error=i=b||o}y.aborted&&(n("upload aborted"),o=null),y.status&&(o=y.status>=200&&y.status<300||304===y.status?"success":"error"),"success"===o?(f.success&&f.success.call(f.context,E,"success",y),x.resolve(y.responseText,"success",y),d&&t.event.trigger("ajaxSuccess",[y,f])):o&&(void 0===i&&(i=y.statusText),f.error&&f.error.call(f.context,y,o,i),x.reject(y,"error",i),d&&t.event.trigger("ajaxError",[y,f,i])),d&&t.event.trigger("ajaxComplete",[y,f]),d&&!--t.active&&t.event.trigger("ajaxStop"),f.complete&&f.complete.call(f.context,y,o),M=!0,f.timeout&&clearTimeout(j),setTimeout(function(){f.iframeTarget?m.attr("src",f.iframeSrc):m.remove(),y.responseXML=null},100)}}}var l,u,f,d,p,m,v,y,b,_,w,j,A=c[0],x=t.Deferred();if(x.abort=function(t){y.abort(t)},i)for(u=0;u<g.length;u++)l=t(g[u]),o?l.prop("disabled",!1):l.removeAttr("disabled");if(f=t.extend(!0,{},t.ajaxSettings,e),f.context=f.context||f,p="jqFormIO"+(new Date).getTime(),f.iframeTarget?(m=t(f.iframeTarget),_=m.attr2("name"),_?p=_:m.attr2("name",p)):(m=t('<iframe name="'+p+'" src="'+f.iframeSrc+'" />'),m.css({position:"absolute",top:"-1000px",left:"-1000px"})),v=m[0],y={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(e){var i="timeout"===e?"timeout":"aborted";n("aborting upload... "+i),this.aborted=1;try{v.contentWindow.document.execCommand&&v.contentWindow.document.execCommand("Stop")}catch(s){}m.attr("src",f.iframeSrc),y.error=i,f.error&&f.error.call(f.context,y,i,e),d&&t.event.trigger("ajaxError",[y,f,i]),f.complete&&f.complete.call(f.context,y,i)}},d=f.global,d&&0===t.active++&&t.event.trigger("ajaxStart"),d&&t.event.trigger("ajaxSend",[y,f]),f.beforeSend&&f.beforeSend.call(f.context,y,f)===!1)return f.global&&t.active--,x.reject(),x;if(y.aborted)return x.reject(),x;b=A.clk,b&&(_=b.name,_&&!b.disabled&&(f.extraData=f.extraData||{},f.extraData[_]=b.value,"image"==b.type&&(f.extraData[_+".x"]=A.clk_x,f.extraData[_+".y"]=A.clk_y)));var C=1,T=2,k=t("meta[name=csrf-token]").attr("content"),S=t("meta[name=csrf-param]").attr("content");S&&k&&(f.extraData=f.extraData||{},f.extraData[S]=k),f.forceSync?a():setTimeout(a,10);var E,D,M,N=50,I=t.parseXML||function(t,e){return window.ActiveXObject?(e=new ActiveXObject("Microsoft.XMLDOM"),e.async="false",e.loadXML(t)):e=(new DOMParser).parseFromString(t,"text/xml"),e&&e.documentElement&&"parsererror"!=e.documentElement.nodeName?e:null},P=t.parseJSON||function(t){return window.eval("("+t+")")},B=function(e,i,n){var s=e.getResponseHeader("content-type")||"",o="xml"===i||!i&&s.indexOf("xml")>=0,a=o?e.responseXML:e.responseText;return o&&"parsererror"===a.documentElement.nodeName&&t.error&&t.error("parsererror"),n&&n.dataFilter&&(a=n.dataFilter(a,i)),"string"==typeof a&&("json"===i||!i&&s.indexOf("json")>=0?a=P(a):("script"===i||!i&&s.indexOf("javascript")>=0)&&t.globalEval(a)),a};return x}if(!this.length)return n("ajaxSubmit: skipping submit process - no element selected"),this;var h,l,u,c=this;"function"==typeof e?e={success:e}:void 0===e&&(e={}),h=e.type||this.attr2("method"),l=e.url||this.attr2("action"),u="string"==typeof l?t.trim(l):"",u=u||window.location.href||"",u&&(u=(u.match(/^([^#]+)/)||[])[1]),e=t.extend(!0,{url:u,success:t.ajaxSettings.success,type:h||t.ajaxSettings.type,iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},e);var f={};if(this.trigger("form-pre-serialize",[this,e,f]),f.veto)return n("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(e.beforeSerialize&&e.beforeSerialize(this,e)===!1)return n("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var d=e.traditional;void 0===d&&(d=t.ajaxSettings.traditional);var p,g=[],m=this.formToArray(e.semantic,g);if(e.data&&(e.extraData=e.data,p=t.param(e.data,d)),e.beforeSubmit&&e.beforeSubmit(m,this,e)===!1)return n("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[m,this,e,f]),f.veto)return n("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var v=t.param(m,d);p&&(v=v?v+"&"+p:p),"GET"==e.type.toUpperCase()?(e.url+=(e.url.indexOf("?")>=0?"&":"?")+v,e.data=null):e.data=v;var y=[];if(e.resetForm&&y.push(function(){c.resetForm()}),e.clearForm&&y.push(function(){c.clearForm(e.includeHidden)}),!e.dataType&&e.target){var b=e.success||function(){};y.push(function(i){var n=e.replaceTarget?"replaceWith":"html";t(e.target)[n](i).each(b,arguments)})}else e.success&&y.push(e.success);if(e.success=function(t,i,n){for(var s=e.context||this,o=0,a=y.length;a>o;o++)y[o].apply(s,[t,i,n||c,c])},e.error){var _=e.error;e.error=function(t,i,n){var s=e.context||this;_.apply(s,[t,i,n,c])}}if(e.complete){var w=e.complete;e.complete=function(t,i){var n=e.context||this;w.apply(n,[t,i,c])}}var j=t("input[type=file]:enabled",this).filter(function(){return""!==t(this).val()}),A=j.length>0,x="multipart/form-data",C=c.attr("enctype")==x||c.attr("encoding")==x,T=s.fileapi&&s.formdata;n("fileAPI :"+T);var k,S=(A||C)&&!T;e.iframe!==!1&&(e.iframe||S)?e.closeKeepAlive?t.get(e.closeKeepAlive,function(){k=r(m)}):k=r(m):k=(A||C)&&T?a(m):t.ajax(e),c.removeData("jqxhr").data("jqxhr",k);for(var E=0;E<g.length;E++)g[E]=null;return this.trigger("form-submit-notify",[this,e]),this},t.fn.ajaxForm=function(s){if(s=s||{},s.delegation=s.delegation&&t.isFunction(t.fn.on),!s.delegation&&0===this.length){var o={s:this.selector,c:this.context};return!t.isReady&&o.s?(n("DOM not ready, queuing ajaxForm"),t(function(){t(o.s,o.c).ajaxForm(s)}),this):(n("terminating; zero elements found by selector"+(t.isReady?"":" (DOM not ready)")),this)}return s.delegation?(t(document).off("submit.form-plugin",this.selector,e).off("click.form-plugin",this.selector,i).on("submit.form-plugin",this.selector,s,e).on("click.form-plugin",this.selector,s,i),this):this.ajaxFormUnbind().bind("submit.form-plugin",s,e).bind("click.form-plugin",s,i)},t.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},t.fn.formToArray=function(e,i){var n=[];if(0===this.length)return n;var o,a=this[0],r=this.attr("id"),h=e?a.getElementsByTagName("*"):a.elements;if(h&&!/MSIE 8/.test(navigator.userAgent)&&(h=t(h).get()),r&&(o=t(":input[form="+r+"]").get(),o.length&&(h=(h||[]).concat(o))),!h||!h.length)return n;var l,u,c,f,d,p,g;for(l=0,p=h.length;p>l;l++)if(d=h[l],c=d.name,c&&!d.disabled)if(e&&a.clk&&"image"==d.type)a.clk==d&&(n.push({name:c,value:t(d).val(),type:d.type}),n.push({name:c+".x",value:a.clk_x},{name:c+".y",value:a.clk_y}));else if(f=t.fieldValue(d,!0),f&&f.constructor==Array)for(i&&i.push(d),u=0,g=f.length;g>u;u++)n.push({name:c,value:f[u]});else if(s.fileapi&&"file"==d.type){i&&i.push(d);var m=d.files;if(m.length)for(u=0;u<m.length;u++)n.push({name:c,value:m[u],type:d.type});else n.push({name:c,value:"",type:d.type})}else null!==f&&"undefined"!=typeof f&&(i&&i.push(d),n.push({name:c,value:f,type:d.type,required:d.required}));if(!e&&a.clk){var v=t(a.clk),y=v[0];c=y.name,c&&!y.disabled&&"image"==y.type&&(n.push({name:c,value:v.val()}),n.push({name:c+".x",value:a.clk_x},{name:c+".y",value:a.clk_y}))}return n},t.fn.formSerialize=function(e){return t.param(this.formToArray(e))},t.fn.fieldSerialize=function(e){var i=[];return this.each(function(){var n=this.name;if(n){var s=t.fieldValue(this,e);if(s&&s.constructor==Array)for(var o=0,a=s.length;a>o;o++)i.push({name:n,value:s[o]});else null!==s&&"undefined"!=typeof s&&i.push({name:this.name,value:s})}}),t.param(i)},t.fn.fieldValue=function(e){for(var i=[],n=0,s=this.length;s>n;n++){var o=this[n],a=t.fieldValue(o,e);null===a||"undefined"==typeof a||a.constructor==Array&&!a.length||(a.constructor==Array?t.merge(i,a):i.push(a))}return i},t.fieldValue=function(e,i){var n=e.name,s=e.type,o=e.tagName.toLowerCase();if(void 0===i&&(i=!0),i&&(!n||e.disabled||"reset"==s||"button"==s||("checkbox"==s||"radio"==s)&&!e.checked||("submit"==s||"image"==s)&&e.form&&e.form.clk!=e||"select"==o&&-1==e.selectedIndex))return null;if("select"==o){var a=e.selectedIndex;if(0>a)return null;for(var r=[],h=e.options,l="select-one"==s,u=l?a+1:h.length,c=l?a:0;u>c;c++){var f=h[c];if(f.selected){var d=f.value;if(d||(d=f.attributes&&f.attributes.value&&!f.attributes.value.specified?f.text:f.value),l)return d;r.push(d)}}return r}return t(e).val()},t.fn.clearForm=function(e){return this.each(function(){t("input,select,textarea",this).clearFields(e)})},t.fn.clearFields=t.fn.clearInputs=function(e){var i=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var n=this.type,s=this.tagName.toLowerCase();i.test(n)||"textarea"==s?this.value="":"checkbox"==n||"radio"==n?this.checked=!1:"select"==s?this.selectedIndex=-1:"file"==n?/MSIE/.test(navigator.userAgent)?t(this).replaceWith(t(this).clone(!0)):t(this).val(""):e&&(e===!0&&/hidden/.test(n)||"string"==typeof e&&t(this).is(e))&&(this.value="")})},t.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})},t.fn.enable=function(t){return void 0===t&&(t=!0),this.each(function(){this.disabled=!t})},t.fn.selected=function(e){return void 0===e&&(e=!0),this.each(function(){var i=this.type;if("checkbox"==i||"radio"==i)this.checked=e;else if("option"==this.tagName.toLowerCase()){var n=t(this).parent("select");e&&n[0]&&"select-one"==n[0].type&&n.find("option").selected(!1),this.selected=e}})},t.fn.ajaxSubmit.debug=!1});